import{j as r,r as E,c as I}from"./iconBase-3b7d111a.js";import{S as y}from"./index-398deebc.js";import{L as g}from"./index-bc7dc0c5.js";import{a as O,R as N}from"./index-39e354ab.js";import{H as P}from"./index-3334a6a5.js";import{P as w}from"./index-be2da344.js";import{u as S}from"./index-a4924570.js";import{u as D}from"./modalStore-d17d7ffe.js";import{Q as j}from"./react-toastify.esm-9ef0ae5c.js";import{V as i}from"./config-bb52a63e.js";import{u as v}from"./useQueryState-f450e7e7.js";import{o as V}from"./index-6161b94e.js";import{T}from"./index-5799cdaf.js";import{h as k,N as q}from"./index-7c3fcb85.js";import"./index-ac0909fd.js";import"./formik.esm-ac5c4b53.js";import"./index.esm-047accf7.js";import"./index-602607c3.js";import"./index-1773b9ca.js";import"./index-0ad39150.js";import"./getMaximiumRol-3d17b9cf.js";import"./capitalize-1790f93b.js";import"./validationSchemaUserDto-9dd65add.js";import"./object-be89183a.js";import"./QueryClientProvider.esm-05af3f1d.js";import"./DataTable-aa997715.js";import"./dayjs.min-5ff67288.js";async function B(s){const{queryKey:t}=s,{data:e}=await S.getUser(t[1]);return e}function L(s){return v(["user",s],B,{})}async function M(s){const{data:t}=await V.getOrdersByIdUser(s.queryKey[1]);return t}function _(s){return v(["orders-by-user",s],M,[])}const H=s=>{const{id:t}=s,{data:e,setData:u,refetch:c,isFetching:p}=_(t);return r.exports.jsx(T,{orders:e,setOrders:u,refetch:c,isFetching:p})},R=[i.ADMIN,i.SUPER_USER],Ue=s=>{var d,f,x,U,h;const t=k(),{data:e,isFetching:u,setData:c,error:p}=L(t.id),{user:m}=D();if(u)return r.exports.jsx(g,{loading:!0});if(!Object.keys(e).length&&p)return r.exports.jsx(q,{to:O.users.path});async function b(o){var n;try{(n=o.password)!=null&&n.trim()||delete o.password;const a=await S.updateUser(e.iduser,o);c(a.data),j.success("User updated successfully.")}catch(a){console.log(a),j.error(a.response.data.message||"Error updating user")}}if(!Object.keys(e).length)return r.exports.jsx(g,{loading:!0});const l=e.iduser!==m.iduser&&!((d=e.roles)!=null&&d.includes(i.SUPER_USER))&&((f=e.roles)==null?void 0:f.includes(i.ADMIN))&&((x=m.roles)==null?void 0:x.includes(i.SUPER_USER))||((U=e.roles)==null?void 0:U.includes(i.USER)),A=(h=m.roles)==null?void 0:h.some(o=>R.includes(o));return r.exports.jsxs(E.exports.Fragment,{children:[r.exports.jsx(P,{to:"/users",children:"Users"}),r.exports.jsx(w,{user:e,onSubmitUpdateUser:b,validRolesActions:R,canUseActions:l,extraInitialValuesFormUpdate:{isActive:e.isActive,roles:e.roles},extraInputsFormFormUpdate:r.exports.jsxs(r.exports.Fragment,{children:[r.exports.jsx(y,{name:"isActive",options:[{value:!0,label:"Active"},{value:!1,label:"Inactive"}]}),r.exports.jsx(y,{multiple:!0,name:"roles",options:[{value:i.ADMIN,label:"Admin"},{value:i.USER,label:"User"}],onChange:(o,n)=>{if(!o)return n;const a=[...o];return a.length===2&&a.shift(),a.map(F=>F.value)}})]})}),r.exports.jsx(N,{isTrue:!0,children:r.exports.jsx("div",{className:I("tile",l&&A?"mt-10":"mt-64"),children:r.exports.jsx(H,{id:t.id})})})]})};export{Ue as default};
