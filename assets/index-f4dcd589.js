import{r as i,j as e,c as g}from"./iconBase-3b7d111a.js";import{_,R as w,a as A}from"./index-39e354ab.js";import{H as E}from"./index-3334a6a5.js";import{o as R}from"./index-6161b94e.js";import{u as D}from"./useQueryState-f450e7e7.js";import{T as V,p as u}from"./index-5799cdaf.js";import{D as q,a as L}from"./DataTable-aa997715.js";import{e as H,f as U,g as z,h as Q}from"./index.esm-047accf7.js";import{Q as x}from"./react-toastify.esm-9ef0ae5c.js";import{I as p,B as K}from"./index-ac0909fd.js";import{F as $,a as G}from"./formik.esm-ac5c4b53.js";import{c as J,a as W}from"./object-be89183a.js";import"./config-bb52a63e.js";import"./index-602607c3.js";import"./index-7c3fcb85.js";import"./index-bc7dc0c5.js";import"./QueryClientProvider.esm-05af3f1d.js";import"./modalStore-d17d7ffe.js";import"./dayjs.min-5ff67288.js";import"./index-1773b9ca.js";import"./capitalize-1790f93b.js";async function X(a){const{data:t}=await R.getOrdersByPaymentMethod(a.queryKey[1]);return t}function Y(a){return D(["orders-by-payment",a],X,[])}const Z=a=>{const{id:t}=a,{refetch:s,data:o,setData:r,isFetching:d}=Y(t);return i.exports.useEffect(()=>{s()},[t]),e.exports.jsx("div",{className:"tile",children:e.exports.jsx(V,{orders:o,setOrders:r,refetch:s,isFetching:d})})},ee=J({title:W().required("Name is required")}),te=a=>{const{state:t,paymentMethod:s,onSuccess:o}=a,r=t==="create"?{title:"",owner:"",phone:"",email:"",dni:""}:{title:s.title,owner:s.owner,phone:s.phone,email:s.email,dni:s.dni};async function d(c,m){try{let l;t==="create"?l=await u.createOne(c):t==="update"&&(l=await u.updateOne(s.idpaymentmethod,c)),x.success(t==="create"?"Payment Method created successfully":"Payment Method updated successfully"),o(l.data),t==="create"&&m.resetForm()}catch(l){console.log(l),x.error("There was an error setting the payment method")}}return e.exports.jsx($,{initialValues:r,onSubmit:d,enableReinitialize:!0,validationSchema:ee,children:e.exports.jsxs(G,{children:[e.exports.jsx(p,{label:"Name",name:"title",placeholder:"Name of payment method"}),e.exports.jsx(p,{label:"Owner",name:"owner",placeholder:"Owner of payment method"}),e.exports.jsx(p,{label:"Phone",name:"phone",placeholder:"Phone of payment method"}),e.exports.jsx(p,{label:"Email",name:"email",placeholder:"Email of payment method phone"}),e.exports.jsx(p,{label:"DNI",name:"dni",placeholder:"DNI of payment method DNI"}),e.exports.jsx(K,{className:g("btn-sm",t==="create"&&"btn-primary",t==="update"&&"btn-danger"),full:!0,children:t==="create"?"Create Payment Method":"Update Payment Method"})]})})};async function se(){const{data:a}=await u.getAll();return a}function ae(){return D(["payment-methods"],se,[])}const oe=[{title:"ID",field:"idpaymentmethod",center:!0},{title:"Name",field:"title",center:!0},{title:"Owner",field:"owner",center:!0},{title:"DNI",field:"dni",center:!0},{title:"Email",field:"email",center:!0},{title:"Actions",field:"actions",center:!0}],ne=a=>{const{paymentMethod:t,deletePaymentMethod:s,updatePaymentMethod:o,setViewOrdersByPaymentMethod:r}=a,d=()=>s(t),c=()=>o(t),m=()=>r(t);return e.exports.jsxs("div",{className:"grid grid-cols-2",children:[e.exports.jsx("button",{className:"btn btn-success btn-xs",onClick:m,children:e.exports.jsx(H,{})}),e.exports.jsx("button",{className:"btn btn-primary btn-xs",onClick:c,children:e.exports.jsx(U,{})}),e.exports.jsx("button",{className:"btn btn-danger btn-xs col-span-2",onClick:d,children:e.exports.jsx(z,{})})]})},re=a=>{const{paymentMethods:t,updatePaymentMethod:s,deletePaymentMethod:o,setViewOrdersByPaymentMethod:r}=a;return t.map(d=>({...d,actions:e.exports.jsx(ne,{setViewOrdersByPaymentMethod:r,paymentMethod:d,updatePaymentMethod:s,deletePaymentMethod:o})}))},de=i.exports.lazy(()=>_(()=>import("./ModalDeletePaymentMethod-7715fcd9.js"),["assets/ModalDeletePaymentMethod-7715fcd9.js","assets/iconBase-3b7d111a.js","assets/ConfirmModal-8f8003a5.js","assets/Modal-be6ca283.js","assets/index-bc7dc0c5.js","assets/index-39e354ab.js","assets/config-bb52a63e.js","assets/index.esm-047accf7.js","assets/create-visual-element-6082da53.js"])),N=a=>{const{heading:t,setSelected:s}=a,[o,r]=i.exports.useState("create"),[d,c]=i.exports.useState(null),[m,l]=i.exports.useState(!1),[F,P]=i.exports.useState(!1),[y,M]=i.exports.useState(null),{isFetching:S,data:h,setData:f,refetch:O}=ae();function v(n){o==="create"?f([n,...h]):o==="update"&&f(h.map(j=>j.idpaymentmethod===n.idpaymentmethod?{...n}:j))}function T(n){l(!0),M(n)}function b(){l(!1),M(null)}async function I(){try{P(!0),await u.deleteOne(y.idpaymentmethod),f(h.filter(n=>n.idpaymentmethod!==y.idpaymentmethod)),b(),x.success("Payment Method deleted successfully")}catch(n){console.log(n),x.error(n.response.data.message||"There was an error deleting the user")}finally{P(!1)}}function k(n){c(n),r("update")}function B(){c(null),r("create")}function C(n){s(n.idpaymentmethod)}return e.exports.jsxs("div",{className:"grid lg:grid-cols-5 gap-4",children:[e.exports.jsx("div",{className:"lg:col-span-3",children:e.exports.jsx("div",{className:"tile",children:e.exports.jsx(q,{buttons:e.exports.jsxs(e.exports.Fragment,{children:[e.exports.jsx("button",{className:"btn btn-primary btn-xs",onClick:B,children:e.exports.jsx(Q,{})}),e.exports.jsx("button",{className:"btn btn-outline-alternative btn-xs",onClick:()=>O(),children:e.exports.jsx(L,{})})]}),loading:S,data:re({paymentMethods:h,updatePaymentMethod:k,deletePaymentMethod:T,setViewOrdersByPaymentMethod:C}),heading:t})})}),e.exports.jsxs("div",{className:"lg:col-span-2",children:[e.exports.jsx("div",{className:g("tile mb-0 rounded-b-none text-white py-3",o==="create"&&"bg-blue-600",o==="update"&&"bg-red-600"),children:e.exports.jsx("h6",{children:o==="create"?"Create Payment Method":"Update Payment Method"})}),e.exports.jsx("div",{className:"tile rounded-t-none",children:e.exports.jsx(te,{state:o,onSuccess:v,paymentMethod:d})})]}),e.exports.jsx(w,{isTrue:m,children:e.exports.jsx(de,{onAcceptDeletePaymentMethod:I,onCloseModalDelete:b,isLoading:F,showModalDeletePaymentMethod:m,paymentMethod:y})})]})};N.defaultProps={heading:oe};const ve=a=>{const[t,s]=i.exports.useState(null);return e.exports.jsxs(i.exports.Fragment,{children:[e.exports.jsx(E,{to:A.settings.path,children:"Settings"}),e.exports.jsx(N,{setSelected:s}),e.exports.jsx(w,{isTrue:t,children:e.exports.jsx(Z,{id:t})})]})};export{ve as default};
