import{a as k,R as x,_ as U}from"./index-39e354ab.js";import{j as e,r as o,c as w}from"./iconBase-3b7d111a.js";import{D as I,a as L}from"./DataTable-aa997715.js";import{u as Y}from"./index-a4924570.js";import{u as V,a as F}from"./modalStore-d17d7ffe.js";import{e as z,f as H,g as O,h as B}from"./index.esm-047accf7.js";import{Q as A}from"./react-toastify.esm-9ef0ae5c.js";import{g as Q}from"./getMaximiumRol-3d17b9cf.js";import{d as v}from"./dayjs.min-5ff67288.js";import{V as d}from"./config-bb52a63e.js";import{L as W}from"./index-602607c3.js";const q=[{title:"ID",field:"iduser"},{title:"First Name",field:"firstName"},{title:"Last Name",field:"lastName"},{title:"Email",field:"email"},{title:"Rol",field:"userRol"},{title:"Phone",field:"phone"},{title:"Date Created",field:"dateCreatedFormatted",center:!0},{title:"Status",field:"isActiveFormatted",center:!0},{title:"Actions",field:"actions",center:!0}],G=a=>{var c;const{user:s,onUpdateUser:l,onDeleteUser:n}=a,{user:r}=V(),i=()=>l(s),p=()=>n(s),u=s.iduser!==r.iduser&&!s.roles.includes(d.SUPER_USER)&&s.roles.includes(d.ADMIN)&&((c=r.roles)==null?void 0:c.includes(d.SUPER_USER))||s.roles.includes(d.USER);return e.exports.jsxs(o.exports.Fragment,{children:[e.exports.jsx(W,{to:k.viewUser.fnPath(s.iduser),className:"btn btn-success btn-xs",children:e.exports.jsx(z,{})}),e.exports.jsxs(x,{isTrue:u,children:[e.exports.jsx("button",{className:"btn btn-primary btn-xs",onClick:i,children:e.exports.jsx(H,{})}),e.exports.jsx("button",{className:"btn btn-danger btn-xs",onClick:p,children:e.exports.jsx(O,{})})]})]})},J=a=>{const{isActive:s}=a;return e.exports.jsx("span",{className:w("btn btn-xs cursor-default btn-pill px-5 w-full",s?"btn-success":"btn-danger"),children:s?"Active":"Inactive"})},K=a=>{const{users:s,onDeleteUser:l,onUpdateUser:n}=a;return s.map(r=>({...r,isActiveFormatted:e.exports.jsx(J,{isActive:r.isActive}),actions:e.exports.jsx(G,{user:r,...a}),userRol:Q(r.roles),dateCreatedFormatted:v(r.dateCreated).format("DD/MM/YYYY HH:mm:ss"),dateCreatedFormattedWithouHour:v(r.dateCreated).format("DD/MM/YYYY"),fullName:r.firstName+" "+r.lastName}))},X=o.exports.lazy(()=>U(()=>import("./FormCreateUser-5816a8a1.js"),["assets/FormCreateUser-5816a8a1.js","assets/iconBase-3b7d111a.js","assets/formik.esm-ac5c4b53.js","assets/config-bb52a63e.js","assets/index-a4924570.js","assets/index-39e354ab.js","assets/useTimeOutMessage-d962b019.js","assets/index-ac0909fd.js","assets/index-01e57b3f.js","assets/index.esm-b0814b9a.js","assets/index-e8a8613b.js","assets/motion-3fe2d343.js","assets/create-visual-element-6082da53.js","assets/react-toastify.esm-9ef0ae5c.js","assets/index-398deebc.js","assets/validationSchemaUserDto-9dd65add.js","assets/object-be89183a.js"])),Z=o.exports.lazy(()=>U(()=>import("./FormUpdateUser-0e0d5622.js"),["assets/FormUpdateUser-0e0d5622.js","assets/iconBase-3b7d111a.js","assets/index-ac0909fd.js","assets/index-39e354ab.js","assets/config-bb52a63e.js","assets/formik.esm-ac5c4b53.js","assets/index-398deebc.js","assets/index-01e57b3f.js","assets/index.esm-b0814b9a.js","assets/index-e8a8613b.js","assets/motion-3fe2d343.js","assets/create-visual-element-6082da53.js","assets/index-a4924570.js","assets/useTimeOutMessage-d962b019.js","assets/react-toastify.esm-9ef0ae5c.js","assets/validationSchemaUserDto-9dd65add.js","assets/object-be89183a.js"])),$=o.exports.lazy(()=>U(()=>import("./ModalDeleteUser-b9e7e3f7.js"),["assets/ModalDeleteUser-b9e7e3f7.js","assets/iconBase-3b7d111a.js","assets/ConfirmModal-8f8003a5.js","assets/Modal-be6ca283.js","assets/index-bc7dc0c5.js","assets/index-39e354ab.js","assets/config-bb52a63e.js","assets/index.esm-047accf7.js","assets/create-visual-element-6082da53.js"])),ee=a=>{const{isFetching:s,setUsers:l,users:n,heading:r,refetch:i,validRol:p,showCreate:u,showPagination:c,showSearch:y}=a,j=F(t=>t.setModal),b=F(t=>t.closeModal),[g,D]=o.exports.useState(!1),[m,C]=o.exports.useState(null),[M,R]=o.exports.useState(!1);async function N(){function t(f){l([f,...n]),b()}j({title:"Create User",children:e.exports.jsx(o.exports.Suspense,{fallback:e.exports.jsx(e.exports.Fragment,{}),children:e.exports.jsx(X,{onSuccess:t,defaultValidRole:[p]})}),size:"md"})}async function E(t){D(!0),C(t)}async function P(t){function f(_){l(n.map(h=>h.iduser===_.iduser?{...h,..._}:h)),b()}j({title:"Update User",children:e.exports.jsx(o.exports.Suspense,{fallback:e.exports.jsx(e.exports.Fragment,{}),children:e.exports.jsx(Z,{user:t,onSuccess:f})}),size:"md"})}const S=()=>{D(!1),C(null)},T=async()=>{try{R(!0),await Y.deleteUser(m.iduser),l(n.filter(t=>t.iduser!==m.iduser)),S(),A.success("User deleted successfully")}catch(t){console.log(t),A.error(t.response.data.message||"There was an error deleting the user")}finally{R(!1)}};return e.exports.jsxs(e.exports.Fragment,{children:[e.exports.jsx(I,{buttons:e.exports.jsxs(e.exports.Fragment,{children:[e.exports.jsx(x,{isTrue:u,children:e.exports.jsx("button",{title:"Add User",className:"btn btn-primary btn-xs",onClick:N,children:e.exports.jsx(B,{})})}),e.exports.jsx(x,{isTrue:i,children:e.exports.jsx("button",{className:"btn btn-outline-alternative btn-xs",onClick:i,children:e.exports.jsx(L,{})})})]}),data:K({users:n,onDeleteUser:E,onUpdateUser:P}),heading:r,loading:s,showPagination:c,showSearch:y}),e.exports.jsx(x,{isTrue:g,children:e.exports.jsx(o.exports.Suspense,{fallback:e.exports.jsx(e.exports.Fragment,{}),children:e.exports.jsx($,{isLoading:M,user:m,showModalDeleteUser:g,onAcceptDeleteUser:T,onCloseModalDelete:S})})})]})};ee.defaultProps={showCreate:!0,heading:q};export{ee as T};
