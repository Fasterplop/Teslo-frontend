import{a as L,f as v,P as E,_ as m,R as N}from"./index-39e354ab.js";import{j as e,r as s}from"./iconBase-3b7d111a.js";import{D as T,a as R}from"./DataTable-aa997715.js";import{a as D}from"./modalStore-d17d7ffe.js";import{e as A,f as I,g as U,h as O}from"./index.esm-047accf7.js";import{c as Y}from"./capitalize-1790f93b.js";import{d as H}from"./dayjs.min-5ff67288.js";import{L as V}from"./index-602607c3.js";import{Q as d}from"./react-toastify.esm-9ef0ae5c.js";import{p as q}from"./index-59c680b6.js";import{c as F}from"./index-c48ce783.js";import{a as _,h as w}from"./index-bc7dc0c5.js";const G=[{title:"Image",field:"image",center:!0},{title:"Name",field:"title"},{title:"Gender",field:"gender",center:!0},{title:"Sizes",field:"sizesFormatted",center:!0},{title:"Price",field:"priceFormatted",center:!0},{title:"Stock",field:"stock",center:!0},{title:"Category",field:"category.title",center:!0},{title:"Date Created",field:"dateFormatted",center:!0},{title:"Actions",field:"actions",center:!0}],Q=i=>{const{product:o,onDeleteProduct:c,onUpdateProduct:l}=i,r=()=>l(o),p=()=>c(o);return e.exports.jsxs("div",{children:[e.exports.jsx(V,{to:L.viewProduct.fnPath(o.id),className:"btn btn-success btn-xs",children:e.exports.jsx(A,{})}),e.exports.jsx("button",{className:"btn btn-primary btn-xs",onClick:r,children:e.exports.jsx(I,{})}),e.exports.jsx("button",{className:"btn btn-danger btn-xs",onClick:p,children:e.exports.jsx(U,{})})]})},B=i=>{const{products:o,onDeleteProduct:c,onUpdateProduct:l}=i;return o.map(r=>({...r,priceFormatted:v.format(r.price),sizesFormatted:r.sizes.join(", "),image:e.exports.jsx("img",{src:r.images.length?E+"/product/"+r.images[r.images.length-1]:"/img/others/box.png",className:"w-24 mx-auto",loading:"lazy"}),dateFormatted:H(r.dateCreated).format("DD/MM/YYYY HH:mm:ss"),gender:Y(r.gender),actions:e.exports.jsx(Q,{onDeleteProduct:c,onUpdateProduct:l,product:r})}))},J=s.exports.lazy(()=>m(()=>import("./ModalDeleteProduct-1735db89.js"),["assets/ModalDeleteProduct-1735db89.js","assets/iconBase-3b7d111a.js","assets/ConfirmModal-8f8003a5.js","assets/Modal-be6ca283.js","assets/index-bc7dc0c5.js","assets/index-39e354ab.js","assets/config-bb52a63e.js","assets/index.esm-047accf7.js","assets/create-visual-element-6082da53.js"])),K=s.exports.lazy(()=>m(()=>import("./FormCreateProduct-016b6e21.js"),["assets/FormCreateProduct-016b6e21.js","assets/iconBase-3b7d111a.js","assets/index-ac0909fd.js","assets/index-39e354ab.js","assets/config-bb52a63e.js","assets/formik.esm-ac5c4b53.js","assets/validationSchemaFormProduct-de56b044.js","assets/index-398deebc.js","assets/capitalize-1790f93b.js","assets/DataTable-aa997715.js","assets/index.esm-047accf7.js","assets/react-toastify.esm-9ef0ae5c.js","assets/index-e8a8613b.js","assets/index.esm-b0814b9a.js","assets/object-be89183a.js","assets/validationSchemaFormProduct-5384aa7b.css","assets/index-59c680b6.js"])),W=s.exports.lazy(()=>m(()=>import("./FormUpdateProduct-0c485af3.js"),["assets/FormUpdateProduct-0c485af3.js","assets/iconBase-3b7d111a.js","assets/index-ac0909fd.js","assets/index-39e354ab.js","assets/config-bb52a63e.js","assets/formik.esm-ac5c4b53.js","assets/validationSchemaFormProduct-de56b044.js","assets/index-398deebc.js","assets/capitalize-1790f93b.js","assets/DataTable-aa997715.js","assets/index.esm-047accf7.js","assets/react-toastify.esm-9ef0ae5c.js","assets/index-e8a8613b.js","assets/index.esm-b0814b9a.js","assets/object-be89183a.js","assets/validationSchemaFormProduct-5384aa7b.css","assets/index-59c680b6.js"])),le=i=>{const{products:o,setProducts:c,isFetching:l,refetch:r,heading:p}=i,[g,f]=s.exports.useState(!1),[x,h]=s.exports.useState(null),[C,P]=s.exports.useState(null),j=D(t=>t.setModal),b=D(t=>t.closeModal),S=async t=>{const a=n=>{c(o.map(u=>u.id===n.id?{...u,...n}:u)),b()};try{_();const n=await F.getCategories();if(!n.data.length)throw new Error("No categories found, please try adding a new category");j({title:"Update Product",children:e.exports.jsx(s.exports.Suspense,{fallback:e.exports.jsx(e.exports.Fragment,{}),children:e.exports.jsx(W,{product:t,onSuccess:a,categories:n.data})}),size:"xl"})}catch(n){console.log(n),d.error(n.message)}finally{w()}},k=async()=>{const t=a=>{c([a,...o]),b()};try{_();const a=await F.getCategories();if(!a.data.length)throw new Error("No categories found, please try adding a new category");j({title:"Create Product",children:e.exports.jsx(s.exports.Suspense,{fallback:e.exports.jsx(e.exports.Fragment,{}),children:e.exports.jsx(K,{onSuccess:t,categories:a.data})}),size:"xl"})}catch(a){d.error(a.message)}finally{w()}},y=()=>{f(!1),h(null)},z=t=>{f(!0),h(t)},M=async()=>{try{P(!0),await q.deleteProduct(x.id),c(o.filter(t=>t.id!==x.id)),y(),d.success("Product deleted successfully")}catch(t){console.log(t),d.error(t.response.data.message||"There was an error deleting the product. Please try again")}finally{P(!1)}};return e.exports.jsxs(s.exports.Fragment,{children:[e.exports.jsx(T,{buttons:e.exports.jsxs(s.exports.Fragment,{children:[e.exports.jsx("button",{className:"btn btn-primary btn-xs",onClick:k,children:e.exports.jsx(O,{})}),e.exports.jsx("button",{className:"btn btn-outline-alternative btn-xs",onClick:r,children:e.exports.jsx(R,{})})]}),data:B({products:o,onDeleteProduct:z,onUpdateProduct:S}),heading:p||G,loading:l}),e.exports.jsx(N,{isTrue:g,children:e.exports.jsx(s.exports.Suspense,{fallback:e.exports.jsx(e.exports.Fragment,{}),children:e.exports.jsx(J,{onAcceptDeleteProduct:M,onCloseModalDelete:y,showModalDeleteProduct:g,product:x,isLoading:C})})})]})};export{le as T};
